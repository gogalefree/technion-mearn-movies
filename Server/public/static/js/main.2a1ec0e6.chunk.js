(this["webpackJsonpmovies-client"]=this["webpackJsonpmovies-client"]||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),i=n.n(c),s=(n(127),n(128),n(6)),o=n.n(s),l=n(38),u=n(10),p=n(8),m=n(226),d=n(206),j=n(202),b=n(227),f=n(200),h=n(221),v=n(96),x=n.n(v),O=n(53),g=n(201),y=n(207),w=n(197),k=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.primary},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},spinner:{display:"flex",flexDirection:"column",alignItems:"center"},errorStyle:{color:e.palette.error.main,marginTop:e.spacing(3)}}})),N=n(22),S=n.n(N);function C(){return new Promise(function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"/api/movies",e.next=4,S.a.get("/api/movies");case 4:a=e.sent,t(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}())}function T(e){return console.log("updateing",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="/api/movies/"+e._id,c={"Content-Type":"application/json"},t.next=5,S.a.put(r,e,{headers:c});case 5:i=t.sent,n(i),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}function I(e){return console.log("creating",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,"/api/movies",r={"Content-Type":"application/json"},t.next=5,S.a.post("/api/movies",e,{headers:r});case 5:c=t.sent,n(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}function F(e){return console.log("Deleting movie with id: ",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="/api/movies/"+e,console.log("delete url: ",r),t.next=5,S.a.delete(r);case 5:c=t.sent,n(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}function E(e){return new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c,i,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=Array.from(e),t.next=4,C();case 4:c=t.sent,i=c.data,s=i.filter((function(e){return!r.includes(e._id)})),console.log("not seen movies: ",s),n(s),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),alert("Couldnt fetch all movies",t.t0),a(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}())}function B(e){return new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="/api/movies/"+e,t.next=4,S.a.get(r);case 4:c=t.sent,n(c),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),a(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function D(e){return P.apply(this,arguments)}function P(){return(P=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/users/login",console.log("req url: ",n),e.abrupt("return",fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=n(2);function M(){return Object(W.jsxs)(O.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(W.jsx)(f.a,{color:"inherit",href:"https://tpapps.co.il/",children:"Guy Freedman - T.P.Apps"})," ",(new Date).getFullYear(),"."]})}function A(e){var t=e.setToken,n=k(),r=Object(a.useState)(""),c=Object(p.a)(r,2),i=c[0],s=c[1],f=Object(a.useState)(""),v=Object(p.a)(f,2),w=v[0],N=v[1],S=Object(a.useState)(!1),C=Object(p.a)(S,2),T=C[0],I=C[1],F=Object(a.useState)({show:!1,message:"Could Not Log In"}),E=Object(p.a)(F,2),B=E[0],P=E[1],A=function(){var e=Object(u.a)(o.a.mark((function e(n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),P(Object(l.a)(Object(l.a)({},B),{},{show:!1})),I(!0),e.prev=3,e.next=6,D({username:i,password:w});case 6:if(a=e.sent,console.log("login response:",a),a.token){e.next=11;break}return L(),e.abrupt("return");case 11:t(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),L();case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){console.log("error login "),P(Object(l.a)(Object(l.a)({},B),{},{show:!0})),I(!1)};return Object(W.jsxs)(g.a,{component:"main",maxWidth:"xs",children:[Object(W.jsx)(j.a,{}),Object(W.jsxs)("div",{className:n.paper,children:[Object(W.jsx)(m.a,{className:n.avatar,children:Object(W.jsx)(x.a,{})}),Object(W.jsx)(O.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(W.jsxs)("form",{className:n.form,noValidate:!0,onSubmit:A,children:[Object(W.jsx)(b.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){return s(e.target.value)}}),Object(W.jsx)(b.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return N(e.target.value)}}),Object(W.jsx)(d.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,children:"Sign In"})]})]}),Object(W.jsxs)("div",{className:n.spinner,children:[T&&Object(W.jsx)(y.a,{color:"secondary",className:"mt-2"}),B.show&&Object(W.jsx)("h6",{className:n.errorStyle,children:B.message})]}),Object(W.jsx)(h.a,{mt:8,children:Object(W.jsx)(M,{})})]})}function L(){var e=Object(a.useState)(function(){var e=localStorage.getItem("token");return JSON.parse(e)}()),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(function(){var e=localStorage.getItem("fullName");return JSON.parse(e)}()),i=Object(p.a)(c,2),s=i[0],o=i[1];return{setToken:function(e){localStorage.setItem("token",JSON.stringify(e.token)),localStorage.setItem("fullName",JSON.stringify(e.fullName)),r(e.token),o(e.fullName)},token:n,fullName:s}}var U=n(17),z=n(212);function _(){return new Promise(function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"/api/subscriptions",e.next=4,S.a.get("/api/subscriptions");case 4:a=e.sent,t(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}())}function J(e){return console.log("creating",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,"/api/subscriptions",r={"Content-Type":"application/json"},t.next=5,S.a.post("/api/subscriptions",e,{headers:r});case 5:c=t.sent,n(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}var G=n(208),R=n(211),V=n(210),q=n(209),Y=Object(w.a)((function(e){return{root:{minWidth:500,minHeight:440},deleteButton:{color:e.palette.error.dark}}}));function H(e){var t=e.movie,n=e.subscriptions,r=Y(),c=Object(a.useState)(""),i=Object(p.a)(c,2),s=i[0],l=i[1];Object(a.useEffect)((function(){t.geners&&l(t.geners.join(", "))}),[s,t.geners]);var m=Object(a.useState)([]),j=Object(p.a)(m,2),b=j[0],f=j[1],h=Object(U.f)();Object(a.useEffect)((function(){if(n){var e=n.map((function(e){var t=parseInt(e.date),n=new Date(0);return n.setUTCSeconds(t),n.toString().slice(3,15)}));f(e)}}),[n]);var v=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,e.prev=1,e.next=4,F(n);case 4:window.location.reload(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log("error: ",e.t0),alert("Could not delete due to server Error.");case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(G.a,{className:r.root,children:[Object(W.jsx)(q.a,{component:"img",alt:t.name,height:"300",image:t.imageUrl,title:t.name}),Object(W.jsxs)(V.a,{children:[Object(W.jsxs)(O.a,{gutterBottom:!0,variant:"h5",component:"h2",children:[t.name,", ",t.yearPremiered]}),Object(W.jsxs)(O.a,{gutterBottom:!0,variant:"body1",component:"h2",children:["Geners: ",s]}),n.length>0?Object(W.jsx)(O.a,{gutterBottom:!0,variant:"body1",component:"h2",children:"Subscriptions Watched:"}):Object(W.jsx)(O.a,{gutterBottom:!0,variant:"body1",component:"h2",children:"No Subscriptions watched yet"}),Object(W.jsx)(O.a,{variant:"body2",color:"textSecondary",component:"h2",children:Object(W.jsx)("ul",{children:n.map((function(e,t){return Object(W.jsxs)("li",{children:[e.fullName,", ",b[t]]},t)}))})})]}),Object(W.jsxs)(R.a,{children:[Object(W.jsx)(d.a,{size:"small",color:"primary",onClick:function(){localStorage.setItem("movie",JSON.stringify(t));var e="/editMovie/"+t._id;h.push(e)},children:"Edit"}),Object(W.jsx)(d.a,{size:"small",className:r.deleteButton,onClick:v,children:"Delete"})]})]})}var K=Object(w.a)((function(e){return{root:{flexGrow:1,paddingTop:20,alignItems:"center"},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));function Q(){var e=K(),t=Object(a.useState)([{}]),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)([{}]),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(U.f)();Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C();case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Error connecting to server: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function t(){return(t=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_();case 3:t=e.sent,m(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Error connecting to server: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);var b=r.map((function(e,t){return console.log(e._id),Object(W.jsx)(z.a,{item:!0,xs:6,children:Object(W.jsx)(H,{movie:e,subscriptions:l.filter((function(t){return t.moviesId===e._id}))})},t)}));return Object(W.jsxs)("div",{className:e.root,children:[Object(W.jsx)(O.a,{variant:"h3",color:"textSecondary",className:"mb-5",children:"Movies List"}),Object(W.jsx)(d.a,{variant:"outlined",className:"mb-5",disableElevation:!0,color:"primary",onClick:function(){j.push("/createMovie")},children:"Add New Movie"}),Object(W.jsx)(z.a,{container:!0,spacing:5,children:b})]})}var X=n(220),Z=n(222);function $(){var e=Object(a.useState)("/"),t=Object(p.a)(e,2),n=t[0],r=t[1],c=L().fullName,i=Object(U.g)();Object(a.useEffect)((function(){r(i.pathname)}),[i.pathname]);var s={fontSize:18,marginRight:25};return Object(W.jsxs)(X.a,{bg:"dark",variant:"dark",expand:"md",children:[Object(W.jsxs)(X.a.Brand,{children:["Hi, ",c.toUpperCase()]}),Object(W.jsx)(X.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(W.jsx)(X.a.Collapse,{id:"basic-navbar-nav",className:"ml-5",children:Object(W.jsx)(g.a,{children:Object(W.jsxs)(Z.a,{className:"mr-auto",activeKey:n,children:[Object(W.jsx)(Z.a.Item,{children:Object(W.jsx)(Z.a.Link,{href:"/",eventKey:"/",style:s,children:"Movies"})}),Object(W.jsx)(Z.a.Item,{children:Object(W.jsx)(Z.a.Link,{href:"/subscriptions",eventKey:"/subscriptions",style:s,children:"Subscriptions"})}),Object(W.jsx)("div",{style:{flex:1}}),Object(W.jsx)(Z.a.Item,{children:Object(W.jsx)(Z.a.Link,{onClick:function(){localStorage.clear(),window.location.reload()},children:"Logout"})})]})})})]})}var ee=n(219),te=n(213),ne=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:500,marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},spinner:{display:"flex",flexDirection:"column",alignItems:"center"},errorStyle:{color:e.palette.error.main,marginTop:e.spacing(3)},image:{width:500,height:400,objectFit:"cover"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(3)},card:{width:"50vw",marginTop:e.spacing(3)},imgContainer:{textAlign:"center"},deleteButton:{color:e.palette.error.light}}}));function ae(){var e=ne(),t=Object(a.useState)({}),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),s=Object(p.a)(i,2),m=s[0],j=s[1],f=Object(a.useState)(""),h=Object(p.a)(f,2),v=h[0],x=h[1],O=Object(a.useState)([]),g=Object(p.a)(O,2),y=g[0],w=g[1],k=Object(a.useState)(!1),N=Object(p.a)(k,2),S=N[0],C=N[1],I=Object(U.f)();Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("movie"));console.log("m:",e),c(e),j(e.name),x(e.yearPremiered),w(e.geners)}),[]);var F=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(!1),""!==m){e.next=4;break}return C(!0),e.abrupt("return");case 4:return t=Object(l.a)(Object(l.a)({},r),{},{name:m,yearPremiered:parseInt(v),geners:y}),console.log("movie to update: ",t),e.prev=6,e.next=9,T(t);case 9:I.push("/"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),console.log(e.t0),alert("Could not update movie due to network error");case 16:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:e.paper,children:Object(W.jsxs)(G.a,{className:e.card,children:[Object(W.jsx)(te.a,{title:r.name?r.name.toUpperCase():""}),Object(W.jsx)(q.a,{component:"img",alt:r.name,height:"400",image:r.imageUrl,title:r.name}),Object(W.jsx)("div",{className:e.paper,children:Object(W.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(b.a,{fullWidth:!0,id:"name",label:"Movie Title",value:m,onChange:function(e){C(!1),j(e.target.value),""===e.target.value&&C(!0)},className:e.textField,error:S}),Object(W.jsx)(b.a,{fullWidth:!0,id:"year",type:"number",label:"Year Premiered",value:v,onChange:function(e){return x(e.target.value)},className:e.textField}),Object(W.jsx)(b.a,{fullWidth:!0,id:"Geners",label:"Put a Comma between Geners",className:e.textField,value:y.join(", "),onChange:function(e){return w(e.target.value.split(", "))}}),Object(W.jsxs)(R.a,{children:[Object(W.jsx)(d.a,{size:"small",color:"primary",variant:"outlined",className:"mb-3",onClick:F,children:"Update"}),Object(W.jsx)(d.a,{size:"small",color:"secondary",className:"mb-3 ml-4",variant:"outlined",onClick:function(){I.push("/")},children:"Cancel"})]})]})})]})})}var re=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(5),display:"flex",flexDirection:"column",alignItems:"center"},spinner:{display:"flex",flexDirection:"column",alignItems:"center"},errorStyle:{color:e.palette.error.main,marginTop:"-15px"},image:{width:500,height:400,objectFit:"cover"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(3),marginBottom:e.spacing(3),width:"55vw"},card:{width:"60vw",marginTop:e.spacing(3)},imgContainer:{textAlign:"center"},deleteButton:{color:e.palette.error.light},actions:{display:"flex",justifyContent:"left",marginTop:e.spacing(3)}}}));function ce(){var e=re(),t=Object(a.useState)(""),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(2020),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(a.useState)([]),f=Object(p.a)(j,2),h=f[0],v=f[1],x=Object(a.useState)(""),O=Object(p.a)(x,2),g=O[0],y=O[1],w=Object(a.useState)(!1),k=Object(p.a)(w,2),N=k[0],S=k[1],C=Object(U.f)();Object(a.useEffect)((function(){}),[]);var T=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S(!1),""!==r){e.next=4;break}return S(!0),e.abrupt("return");case 4:return t={name:r,premieredYear:l,imageUrl:g,geners:h},console.log("movie to create: ",t),e.prev=6,e.next=9,I(t);case 9:C.push("/"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),console.log(e.t0),alert("Could not create movie due to network error");case 16:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:e.paper,children:Object(W.jsxs)(G.a,{className:e.card,variant:"outlined",children:[Object(W.jsx)(te.a,{title:""===r?"ADD MOVIE":r}),""===g?null:Object(W.jsx)(q.a,{component:"img",alt:r,height:"400",image:g,title:r}),Object(W.jsxs)(V.a,{children:[Object(W.jsx)(b.a,{fullWidth:!0,id:"name",label:"Movie Title",value:r,onChange:function(e){S(!1),c(e.target.value),""===e.target.value&&S(!0)},className:e.textField,error:N,required:!0,margin:"normal"}),N&&Object(W.jsx)("div",{className:e.errorStyle,children:Object(W.jsx)("small",{children:"Title is required"})}),Object(W.jsx)(b.a,{fullWidth:!0,id:"year",type:"number",label:"Year Premiered",value:l,onChange:function(e){return m(e.target.value)},className:e.textField}),Object(W.jsx)(b.a,{fullWidth:!0,id:"Geners",label:"Geners - Put a Comma between Geners",className:e.textField,value:h.join(", "),onChange:function(e){return v(e.target.value.split(", "))}}),Object(W.jsx)(b.a,{fullWidth:!0,id:"imageUrl",label:"Image Url",className:e.textField,value:g,onChange:function(e){return y(e.target.value)}}),Object(W.jsxs)(R.a,{className:e.actions,children:[Object(W.jsx)(d.a,{size:"small",color:"primary",variant:"outlined",className:"mb-3",onClick:T,children:"ADD MOVIE"}),Object(W.jsx)(d.a,{size:"small",color:"secondary",className:"mb-3 ml-4",variant:"outlined",onClick:function(){C.push("/")},children:"CANCEL"})]})]})]})})}function ie(){return new Promise(function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"/api/members",e.next=4,S.a.get("/api/members");case 4:a=e.sent,t(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}())}function se(e){return console.log("creating",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,"/api/members",r={"Content-Type":"application/json"},t.next=5,S.a.post("/api/members",e,{headers:r});case 5:c=t.sent,n(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}function oe(e,t){return new Promise(function(){var n=Object(u.a)(o.a.mark((function n(a,r){var c,i,s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c="/api/members/"+e,i={"Content-Type":"application/json"},n.next=5,S.a.put(c,t,{headers:i});case 5:s=n.sent,a(s),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),r(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}())}function le(e){return console.log("Deleting member with id: ",e),new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n,a){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="/api/members/"+e,console.log("delete url: ",r),t.next=5,S.a.delete(r);case 5:c=t.sent,n(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}var ue=Object(w.a)((function(e){return{root:{display:"flex",alignItems:"center",textAlign:"middle",marginTop:"10px",marginBottom:"10px"},details:{display:"flex",flexDirection:"column"},cover:{width:40,height:50,marginLeft:e.spacing(1)}}}));function pe(e){var t=e.subscription,n=void 0===t?{}:t,r=ue(),c=Object(U.f)();Object(a.useEffect)((function(){n&&console.log(n)}),[]);return Object(W.jsxs)(G.a,{className:r.root,variant:"outlined",children:[Object(W.jsx)(q.a,{component:"img",alt:n.name,height:"50",image:n.movieUrl,title:n.movieName,className:r.cover}),Object(W.jsx)("div",{className:r.details,children:Object(W.jsx)(V.a,{children:Object(W.jsxs)(O.a,{variant:"body2",component:"h6",children:[Object(W.jsxs)(f.a,{onClick:function(){var e="/movieDetails/"+n.moviesId;c.push(e)},children:[n.movieName," "]}),","," ",function(e){console.log("readable date: ",e);var t=parseInt(e),n=new Date(0);return n.setUTCSeconds(t),n.toString().slice(3,15)}(n.date)]})})})]})}var me=n(225),de=n(217),je=n(216),be=n(215),fe=n(205),he=n(230),ve=n(231),xe=n(223),Oe=n(214),ge=r.a.forwardRef((function(e,t){return Object(W.jsx)(Oe.a,Object(l.a)({direction:"up",ref:t},e))})),ye=Object(w.a)((function(e){return{form:{display:"flex",flexDirection:"column",margin:"auto",width:"fit-content"},formControl:{marginTop:e.spacing(2),marginBottom:e.spacing(5),minWidth:150},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:e.spacing(2),width:200}}}));function we(e){var t=e.isOpen,n=e.name,a=e.memberId,c=e.movies,i=e.didClose,s=ye(),l=r.a.useState(""),m=Object(p.a)(l,2),j=m[0],f=m[1],h=r.a.useState(""),v=Object(p.a)(h,2),x=v[0],O=v[1],g=r.a.useState(""),y=Object(p.a)(g,2),w=y[0],k=y[1],N=!1,S=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==x&&""!==j){e.next=3;break}return alert("Movie and date must be picked"),e.abrupt("return");case 3:return N=!0,console.log("memberId",a),t={memberId:a,moviesId:x,date:j},e.prev=6,e.next=9,J(t);case 9:e.sent,N=!1,i(!0),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),alert("Server Error: Subscription Not Created"),N=!1;case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}(),C=[];return c&&(C=c.map((function(e,t){return Object(W.jsx)(ve.a,{value:e._id,children:e.name},t)}))),Object(W.jsx)(r.a.Fragment,{children:Object(W.jsxs)(me.a,{fullWidth:!0,maxWidth:"md",open:t,onClose:function(){N||i(!1)},"aria-labelledby":"add-sub-dialog-title",TransitionComponent:ge,children:[Object(W.jsxs)(be.a,{id:"add-sub-dialog-title",children:["Add Subscription - ",n]}),Object(W.jsx)(je.a,{children:Object(W.jsxs)("form",{className:s.form,noValidate:!0,children:[Object(W.jsxs)(fe.a,{className:s.formControl,children:[Object(W.jsx)(he.a,{htmlFor:"movie-name",children:"Movie To Watch"}),Object(W.jsx)(xe.a,{autoFocus:!0,value:w,onChange:function(e){var t=e.target.value;k(t),O(t)},inputProps:{name:"movie-name",id:"movie-name"},children:C})]}),Object(W.jsx)(b.a,{id:"date",label:"Subscription Date",type:"date",defaultValue:j,className:s.textField,InputLabelProps:{shrink:!0},onChange:function(e){var t=e.target.value,n=new Date(t),a=parseInt(Number(n)/1e3);f(parseInt(a)),console.log("date string: ",t),console.log("date: ",n),console.log("epoch: ",a)}})]})}),Object(W.jsxs)(de.a,{children:[Object(W.jsx)(d.a,{onClick:function(){i(!1)},color:"secondary",children:"Cancel"}),Object(W.jsx)(d.a,{onClick:S,color:"primary",disabled:""===x||""===j,children:"Subscribe"})]})]})})}var ke=n(218);function Ne(e){var t=e.open,n=e.didFinish,r=e.member,c=Object(a.useState)(!1),i=Object(p.a)(c,2),s=i[0],l=i[1],m=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete: ",r._id),l(!0),t=r._id,e.prev=3,e.next=6,le(t);case 6:e.sent,l(!1),n(!0),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("error: ",e.t0),alert("Could not delete due to server Error.");case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{children:Object(W.jsxs)(me.a,{open:t,onClose:function(){s||n(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsx)(be.a,{id:"alert-dialog-title",children:"Delete ".concat(r.fullName,"?")}),Object(W.jsx)(je.a,{children:Object(W.jsx)(ke.a,{id:"alert-dialog-description",children:"This will delete the member and all of their subscriptions. This operation can not be undone."})}),Object(W.jsxs)(de.a,{children:[Object(W.jsx)(d.a,{onClick:function(){n(!1)},color:"primary",children:"Cancel"}),Object(W.jsx)(d.a,{onClick:m,color:"primary",autoFocus:!0,children:"Delete"})]})]})})}var Se=Object(w.a)((function(e){return{root:{maxWidth:500},deleteButton:{color:e.palette.error.dark},addSubButton:{color:e.palette.primary.main,marginLeft:e.spacing(2),marginBottom:e.spacing(3)},subTitle:{color:e.palette.grey[800],marginLeft:e.spacing(2),marginTop:e.spacing(4),marginBottom:e.spacing(1)}}}));function Ce(e){var t=e.subscriptions,n=e.member,r=Se(),c=Object(U.f)(),i=Object(a.useState)(!1),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(a.useState)([{}]),b=Object(p.a)(j,2),f=b[0],h=b[1],v=Object(a.useState)(!1),x=Object(p.a)(v,2),g=x[0],y=x[1];Object(a.useEffect)((function(){}),[t,n]);var w=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(u.a)(o.a.mark((function e(){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=15;break}return n=t.map((function(e){return e.moviesId})),a=new Set(n),e.prev=3,console.log("fetch not seen"),e.next=7,E(a);case 7:r=e.sent,h(r),m(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log("error getting movies not seen",e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(G.a,{className:r.root,raised:!0,children:[Object(W.jsx)(te.a,{type:"title",title:n.fullName}),Object(W.jsxs)(V.a,{children:[Object(W.jsx)(O.a,{gutterBottom:!0,variant:"body1",component:"h2",children:n.city}),Object(W.jsx)(O.a,{gutterBottom:!0,variant:"body1",component:"h2",children:n.email})]}),Object(W.jsxs)(R.a,{children:[Object(W.jsx)(d.a,{size:"small",color:"primary",onClick:function(){localStorage.setItem("member",JSON.stringify(n));var e=n._id,t="/editMember/".concat(e);c.push(t)},children:"Edit"}),Object(W.jsx)(d.a,{size:"small",className:r.deleteButton,onClick:w,children:"Delete"})]}),Object(W.jsx)("hr",{}),Object(W.jsx)(O.a,{variant:"h6",className:r.subTitle,children:t.length>0?"SUBSCRIPTIONS WATCHED":"NO SUBSCRIPTIONS YET"}),Object(W.jsx)(d.a,{size:"small",className:r.addSubButton,onClick:k,children:"Add Subscription"}),Object(W.jsx)(we,{isOpen:l,name:n.fullName,movies:f,didClose:function(e){e&&window.location.reload(),m(!1)},memberId:n._id}),t&&t.map((function(e,t){return Object(W.jsx)(pe,{subscription:e},t)}))]}),Object(W.jsx)(Ne,{open:g,didFinish:function(e){y(!1),e&&window.location.reload()},member:n})]})}var Te=Object(w.a)((function(e){return{root:{flexGrow:1,paddingTop:20,alignItems:"center"},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));function Ie(){var e=Te(),t=Object(a.useState)([{}]),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)([{}]),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(U.f)();Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_();case 3:t=e.sent,console.log("subscriptions new: ",t.data),c(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Error connecting to server: ",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function t(){return(t=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie();case 3:t=e.sent,m(t.data),console.log("members: ",t.data),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);return Object(W.jsxs)("div",{className:e.root,children:[Object(W.jsx)(O.a,{variant:"h3",color:"textSecondary",className:"mb-5",children:"Members And Subscriptions"}),Object(W.jsx)(d.a,{variant:"outlined",className:"mb-5",disableElevation:!0,color:"primary",onClick:function(){j.push("/createMember")},children:"Add New Member"}),Object(W.jsx)(z.a,{container:!0,spacing:5,children:l&&l.map((function(e,t){var n=r.filter((function(t){return t.memberId===e._id}));return Object(W.jsx)(z.a,{item:!0,xs:6,children:Object(W.jsx)(Ce,{subscriptions:n,member:e})},t)}))})]})}function Fe(e){var t=Object(a.useState)({}),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)([{}]),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(U.h)().id;Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(j);case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Server error. Could not fetch movie data");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function t(){return(t=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_();case 3:t=e.sent,n=t.data.filter((function(e){return e.moviesId===j})),m(n),console.log("subs: ",n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Server error. Could not fetch movie data");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[j]);return Object(W.jsxs)(W.Fragment,{children:[r&&Object(W.jsxs)(O.a,{align:"center",variant:"h4",style:{marginTop:"20px"},children:[r.name," - Details:"]}),Object(W.jsx)("div",{style:{width:"100%%",display:"flex",justifyContent:"center",marginTop:"20px"},children:l&&Object(W.jsx)(H,{movie:r,subscriptions:l})}),Object(W.jsx)("div",{style:{width:"100%%",display:"flex",justifyContent:"center",marginTop:"20px"},children:Object(W.jsx)(d.a,{variant:"contained",onClick:function(){e.history.goBack()},children:"Back"})})]})}var Ee=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(5),display:"flex",flexDirection:"column",alignItems:"center"},errorStyle:{color:e.palette.error.main,marginTop:e.spacing(3)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(3)},card:{width:"50vw",marginTop:e.spacing(3)}}}));function Be(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(p.a)(c,2),s=i[0],l=i[1],m=Object(a.useState)(""),j=Object(p.a)(m,2),f=j[0],h=j[1],v=Object(a.useState)(!1),x=Object(p.a)(v,2),O=x[0],g=x[1],y=Object(a.useState)(!1),w=Object(p.a)(y,2),k=w[0],N=w[1],S=Object(U.h)().id,C=Ee(),T=Object(U.f)();Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("member"));return console.log(e),r(e.fullName),l(e.email),h(e.city),function(){}}),[]);var I=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(!1),""!==n){e.next=4;break}return g(!0),e.abrupt("return");case 4:return t={fullName:n,email:s,city:f},e.prev=5,e.next=8,oe(S,t);case 8:e.sent,T.push("/subscriptions"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0),alert("Could not update member due to network error");case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:C.paper,children:Object(W.jsxs)(G.a,{className:C.card,raised:!0,children:[Object(W.jsx)(te.a,{title:"Edit User - ".concat(n),className:"mt-3"}),Object(W.jsx)("div",{className:C.paper,children:Object(W.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(b.a,{fullWidth:!0,id:"name",label:"Member Name",value:n,onChange:function(e){g(!1),r(e.target.value),""===e.target.value&&g(!0)},className:C.textField,error:O}),Object(W.jsx)(b.a,{fullWidth:!0,id:"email",type:"email",label:"Email",value:s,onChange:function(e){N(!1),l(e.target.value),""===e.target.value&&N(!0)},className:C.textField,error:k}),Object(W.jsx)(b.a,{fullWidth:!0,id:"city",label:"City",className:C.textField,value:f,onChange:function(e){return h(e.target.value)}}),Object(W.jsxs)(R.a,{children:[Object(W.jsx)(d.a,{size:"small",color:"primary",variant:"outlined",className:"mb-3",onClick:I,disabled:O||k,children:"Update"}),Object(W.jsx)(d.a,{size:"small",color:"secondary",className:"mb-3 ml-4",variant:"outlined",onClick:function(){T.push("/subscriptions")},children:"Cancel"})]})]})})]})})}var De=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(5),display:"flex",flexDirection:"column",alignItems:"center"},errorStyle:{color:e.palette.error.main,marginTop:e.spacing(3)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(3)},card:{width:"50vw",marginTop:e.spacing(3)}}}));function Pe(e){var t=Object(a.useState)(""),n=Object(p.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),s=Object(p.a)(i,2),l=s[0],m=s[1],j=Object(a.useState)(""),f=Object(p.a)(j,2),h=f[0],v=f[1],x=Object(a.useState)(!1),O=Object(p.a)(x,2),g=O[0],y=O[1],w=Object(a.useState)(!1),k=Object(p.a)(w,2),N=k[0],S=k[1],C=De(),T=Object(U.f)(),I=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(!1),""!==r){e.next=4;break}return y(!0),e.abrupt("return");case 4:return t={fullName:r,email:l,city:h},e.prev=5,e.next=8,se(t);case 8:e.sent,T.push("/subscriptions"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0),alert("Could not create member due to network error");case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:C.paper,children:Object(W.jsxs)(G.a,{className:C.card,raised:!0,children:[Object(W.jsx)(te.a,{title:"Create New Member",className:"mt-3"}),Object(W.jsx)("div",{className:C.paper,children:Object(W.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(b.a,{fullWidth:!0,id:"name",label:"Member Name",value:r,onChange:function(e){y(!1),c(e.target.value),""===e.target.value&&y(!0)},className:C.textField,error:g}),Object(W.jsx)(b.a,{fullWidth:!0,id:"email",type:"email",label:"Email",value:l,onChange:function(e){S(!1),m(e.target.value),""===e.target.value&&S(!0)},className:C.textField,error:N}),Object(W.jsx)(b.a,{fullWidth:!0,id:"city",label:"City",className:C.textField,value:h,onChange:function(e){return v(e.target.value)}}),Object(W.jsxs)(R.a,{children:[Object(W.jsx)(d.a,{size:"small",color:"primary",variant:"outlined",className:"mb-3",onClick:I,disabled:g||N||""===r,children:"Create"}),Object(W.jsx)(d.a,{size:"small",color:"secondary",className:"mb-3 ml-4",variant:"outlined",onClick:function(){e.history.goBack()},children:"Cancel"})]})]})})]})})}function We(){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)($,{}),Object(W.jsxs)(ee.a,{children:[Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/",exact:!0,component:Q})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/editMovie/:id",exact:!0,component:ae})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/createMovie",exact:!0,component:ce})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/subscriptions",exact:!0,component:Ie})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/movieDetails/:id",exact:!0,component:Fe})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/editMember/:id",exact:!0,component:Be})}),Object(W.jsx)(U.c,{children:Object(W.jsx)(U.a,{path:"/createMember",exact:!0,component:Pe})})]})]})}var Me=function(){var e=L(),t=e.token,n=e.setToken;return t?(console.log("token exists",t),Object(W.jsx)("div",{className:"App",children:Object(W.jsx)(We,{})})):(console.log("token is null: ",t),Object(W.jsx)(A,{setToken:n}))},Ae=(n(161),n(21));i.a.render(Object(W.jsx)(Ae.a,{children:Object(W.jsx)(Me,{})}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.2a1ec0e6.chunk.js.map